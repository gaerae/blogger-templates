/**
 * Related posts for Blogger Widget
 * @author gaerae
 * @version 1.0
 */
!function($,document){var HELPER_NAMESPACE=$("div.related-posts-widget"),CURRENT_URL,OPTION={blog_url:"",max_posts:5,max_tags:5,posts_per_tag:5,title_use:!0,thumb_use:!0,thumb_default:"",thumb_size:"s72-c",tags:!1,post_page_only:!1,url_querystring:!1,panel_title_related:"Related Posts",panel_title_recent:"Recent Posts",loading_class:"-related-posts-loading"},RelatedPosts={enable:function(){RelatedPosts.onOption(),RelatedPosts.onFeed()},onOption:function(){var _content,_option;if(HELPER_NAMESPACE){var _content=HELPER_NAMESPACE.html().replace(/\n|\r\n/g,"");if((_content=_content.match(/<!--\s*(\{.+\});?\s*--\>/))&&2==_content.length&&(_content=_content[1]),_content){_content.indexOf("{")<0&&(_content="{"+_content+"}");try{_option=eval("("+_content+")")}catch(message){return HELPER_NAMESPACE.html('<b style="color:red">'+message+"</b>"),!1}OPTION=$.extend(OPTION,_option)}}(OPTION.post_page_only?location.pathname.match(/^\/\d{4}\/\d\d\/[\w\-\_]+\.html/):!0)&&(CURRENT_URL=location.protocol+"//"+location.host+location.pathname+(OPTION.url_querystring?location.search:""))},onFeed:function(){var t,e=OPTION.blog_url+"/feeds/posts/summary/";if(OPTION.tags||(OPTION.tags=[],$('a[rel="tag"]:lt('+OPTION.max_tags+")").each(function(){t=$.trim($(this).text().replace(/\n/g,"")),-1==$.inArray(t,OPTION.tags)&&(OPTION.tags[OPTION.tags.length]=t)})),0==OPTION.tags.length)$.ajax({url:e,data:{"max-results":OPTION.max_posts,alt:"json-in-script"},success:RelatedPosts.onContent,dataType:"jsonp",cache:!0});else for(var a=0,n=OPTION.tags.length;n>a;a++)$.ajax({url:e,data:{category:OPTION.tags[a],"max-results":OPTION.posts_per_tag,alt:"json-in-script"},success:RelatedPosts.onContent,dataType:"jsonp",cache:!0})},onContent:function(t){var e,a,n,s,l,o=t.feed.entry.length;if(t.feed.entry){e=0==OPTION.tags.length?OPTION.panel_title_recent:OPTION.panel_title_related,a='<div class="panel panel-primary"><div class="panel-heading"><h3 class="panel-title">'+e+"</h3></div>",a+='<div class="panel-body '+OPTION.loading_class+'">';for(var i=0;o>i;i++){var r=t.feed.entry[i];t:{var c=0,_=r.link.length;for(_;_>c;c++)if("alternate"==r.link[c].rel){s=r.link[c].href;break t}}n=r.title.$t,l=r.media$thumbnail?r.media$thumbnail.url:OPTION.thumb_default,"s72-c"!=OPTION.thumb_size&&(l=l.replace("/s72-c/","/"+OPTION.thumb_size+"/")),(s!=CURRENT_URL||0==OPTION.tags.length)&&(a+='<div class="col-xs-6 col-md-2"><a href="'+s+'" class="thumbnail">'+(OPTION.thumb_use&&l?'<img src="'+l+'" title="'+(OPTION.title_use?"":n)+'" border="0"/>':"")+(OPTION.title_use?n:"")+"</a></div>")}a+="</div></div>",HELPER_NAMESPACE.html(a)}}};$(document).ready(RelatedPosts.enable)}(jQuery,document);
